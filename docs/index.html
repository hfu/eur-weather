<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EUR Weather - ç‚ºæ›¿ãƒŠãƒƒã‚¸</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const j=.01,I=-.01,O=10*60*1e3,w={sunny:{icon:"â˜€ï¸",comments:["è‰¯ã„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™ã€‚ä»Šæ—¥ã¯æ›¿ãˆæ™‚ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚","å¹³å‡ã‚ˆã‚Šæœ‰åˆ©ãªãƒ¬ãƒ¼ãƒˆã§ã™ã€‚æ¤œè¨ã—ã¦ã¿ã¦ã¯ï¼Ÿ","ä»Šæ—¥ã®ãƒ¬ãƒ¼ãƒˆã¯å¥½èª¿ã§ã™ã€‚ãƒãƒ£ãƒ³ã‚¹ã‹ã‚‚ã€‚"]},cloudy:{icon:"â›…",comments:["å¹³å‡çš„ãªãƒ¬ãƒ¼ãƒˆã§ã™ã€‚æ€¥ãã§ãªã‘ã‚Œã°æ§˜å­è¦‹ã‚‚ã€‚","æ¨™æº–çš„ãªæ°´æº–ã§ã™ã€‚ç„¦ã‚‰ãšåˆ¤æ–­ã—ã¾ã—ã‚‡ã†ã€‚","å¹³å‡çš„ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™ã€‚è½ã¡ç€ã„ã¦æ¤œè¨ã‚’ã€‚"]},rainy:{icon:"ğŸŒ§ï¸",comments:["å¹³å‡ã‚ˆã‚Šä¸åˆ©ãªãƒ¬ãƒ¼ãƒˆã§ã™ã€‚å¾…ã¤ã®ã‚‚ä¸€ã¤ã®æ‰‹ã€‚","ä»Šæ—¥ã¯æ§˜å­è¦‹ãŒã‚ˆã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚","å°‘ã—å¾…ã£ã¦ã¿ã‚‹ã®ã‚‚ã‚ã‚Šã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚"]}};function $(t){const e=w[t].comments;return e[Math.floor(Math.random()*e.length)]}function y(t,e){const n=(t-e)/e;return n>=j?"sunny":n<=I?"rainy":"cloudy"}function p(t){return!Array.isArray(t)||t.length===0?0:t.reduce((n,c)=>n+c,0)/t.length}async function h(t,e="EUR"){const n=[],c=new Date;try{const o=c.toISOString().split("T")[0],r=new Date(c);r.setDate(r.getDate()-30);const s=r.toISOString().split("T")[0],l=await fetch(`https://api.frankfurter.app/${s}..${o}?from=${t}&to=${e}`);if(!l.ok)throw new Error("Failed to fetch historical data");const i=await l.json();if(!i||typeof i!="object"||!i.rates||typeof i.rates!="object")return console.error("Unexpected historical rates response structure:",i),n;for(const u in i.rates){const a=i.rates[u];if(!a||typeof a!="object")continue;const d=a[e];typeof d=="number"&&n.push(d)}return n}catch(o){return console.error("Error fetching historical rates:",o),[]}}async function g(t,e="EUR"){try{const n=await fetch(`https://api.frankfurter.app/latest?from=${t}&to=${e}`);if(!n.ok)throw new Error("Failed to fetch current rate");return(await n.json()).rates[e]}catch(n){throw console.error("Error fetching current rate:",n),n}}function v(t){try{const e=localStorage.getItem(t);if(!e)return null;const{data:n,timestamp:c}=JSON.parse(e);return Date.now()-c<O?n:(localStorage.removeItem(t),null)}catch(e){return console.error("Error reading cache:",e),null}}function L(t,e){try{const n={data:e,timestamp:Date.now()};localStorage.setItem(t,JSON.stringify(n))}catch(n){console.error("Error writing cache:",n)}}async function f(t,e){const n=v(t);if(n!==null)return console.log(`Using cached data for ${t}`),n;const c=await e();return L(t,c),c}function E(t,e,n,c){const o=document.getElementById(`${t}-icon`),r=document.getElementById(`${t}-rate`),s=document.getElementById(`${t}-diff`),l=document.getElementById(`${t}-comment`);if(!o||!r||!s||!l){console.warn(`Missing DOM element(s) for prefix "${t}".`,{icon:o,rateEl:r,diffEl:s,commentEl:l});return}o.textContent=w[c].icon;const i=t==="jpy"&&e!==0?1/e:e,u=t==="jpy"?" [ğŸ’´/ğŸ’¶]":" [ğŸ’¶/ğŸ’µ]";if(r.textContent=i.toFixed(t==="jpy"?2:4)+u,n===0)s.textContent="N/A",s.classList.remove("positive","negative");else{const a=e-n,d=(a/n*100).toFixed(2),m=a>=0?"+":"";s.textContent=`${m}${d}%`,s.classList.remove("positive","negative"),a>0?s.classList.add("positive"):a<0&&s.classList.add("negative")}l.textContent=$(c)}async function D(){const t=document.getElementById("loading"),e=document.getElementById("error"),n=document.getElementById("content"),c=document.getElementById("update-time");try{const[o,r,s,l]=await Promise.all([f("jpy-current",()=>g("JPY")),f("jpy-historical",()=>h("JPY")),f("usd-current",()=>g("USD")),f("usd-historical",()=>h("USD"))]),i=Array.isArray(r)&&r.length>0?r:[o],u=Array.isArray(l)&&l.length>0?l:[s],a=p(i),d=p(u),m=y(o,a),S=y(s,d);E("jpy",o,a,m),E("usd",s,d,S),t.style.display="none",n.style.display="block";const A=new Date;c.textContent=`æ›´æ–°: ${A.toLocaleString("ja-JP")}`}catch(o){console.error("Error initializing app:",o),t.style.display="none",e.style.display="block"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",D):D();</script>
  <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px;color:#333}.container{max-width:800px;margin:0 auto}header{text-align:center;color:#fff;margin-bottom:40px}header h1{font-size:2.5rem;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.2)}.subtitle{font-size:1.1rem;opacity:.9}main{margin-bottom:40px}.loading,.error{background:#fff;padding:40px;border-radius:15px;text-align:center;box-shadow:0 10px 30px #0003}.error{background:#fee;color:#c00}.currency-card{background:#fff;border-radius:15px;padding:30px;margin-bottom:20px;box-shadow:0 10px 30px #0003;transition:transform .3s ease}.currency-card:hover{transform:translateY(-5px)}.currency-card h2{font-size:1.5rem;margin-bottom:20px;color:#667eea}.weather-display{display:flex;align-items:center;gap:30px;margin-bottom:20px}.weather-icon{font-size:4rem;min-width:80px;text-align:center}.rate-info{flex:1}.current-rate,.avg-diff{margin-bottom:10px}.label{font-size:.9rem;color:#666;margin-right:10px}.value{font-size:1.2rem;font-weight:700;color:#333}.avg-diff .value{font-size:1rem}.avg-diff .value.positive{color:#28a745}.avg-diff .value.negative{color:#dc3545}.comment{background:#f8f9fa;padding:15px;border-radius:10px;font-size:.95rem;color:#555;border-left:4px solid #667eea;font-style:italic}footer{text-align:center;color:#fff}.note{font-size:.85rem;margin-bottom:10px;opacity:.8}.update-time{font-size:.8rem;opacity:.7}.disclaimer{font-size:.7rem;margin-top:10px;opacity:.6;line-height:1.4}@media (max-width: 600px){header h1{font-size:2rem}.weather-display{flex-direction:column;gap:15px}.currency-card{padding:20px}}</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸŒ EUR Weather</h1>
      <p class="subtitle">ä»Šæ—¥ã®ç‚ºæ›¿ã‚¿ã‚¤ãƒŸãƒ³ã‚°</p>
    </header>
    
    <main>
      <div id="loading" class="loading">
        <p>ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
      </div>
      
      <div id="error" class="error" style="display: none;" aria-live="polite">
        <p>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</p>
      </div>
      
      <div id="content" style="display: none;" aria-live="polite">
        <div class="currency-card">
          <h2>ğŸ‡¯ğŸ‡µ JPY â†’ EUR</h2>
          <div class="weather-display">
            <div class="weather-icon" id="jpy-icon">-</div>
            <div class="rate-info">
              <div class="current-rate">
                <span class="label">ä»Šæ—¥ã®ãƒ¬ãƒ¼ãƒˆ:</span>
                <span class="value" id="jpy-rate">-</span>
              </div>
              <div class="avg-diff">
                <span class="label">30æ—¥å¹³å‡ã¨ã®å·®:</span>
                <span class="value" id="jpy-diff">-</span>
              </div>
            </div>
          </div>
          <p class="comment" id="jpy-comment">-</p>
        </div>
        
        <div class="currency-card">
          <h2>ğŸ‡ºğŸ‡¸ USD â†’ EUR</h2>
          <div class="weather-display">
            <div class="weather-icon" id="usd-icon">-</div>
            <div class="rate-info">
              <div class="current-rate">
                <span class="label">ä»Šæ—¥ã®ãƒ¬ãƒ¼ãƒˆ:</span>
                <span class="value" id="usd-rate">-</span>
              </div>
              <div class="avg-diff">
                <span class="label">30æ—¥å¹³å‡ã¨ã®å·®:</span>
                <span class="value" id="usd-diff">-</span>
              </div>
            </div>
          </div>
          <p class="comment" id="usd-comment">-</p>
        </div>
      </div>
    </main>
    
    <footer>
      <p class="note">â€» ãƒ‡ãƒ¼ã‚¿ã¯å‚è€ƒç”¨ã§ã™ã€‚å®Ÿéš›ã®å–å¼•ãƒ¬ãƒ¼ãƒˆã¨ã¯ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
      <p class="update-time" id="update-time"></p>
      <p class="disclaimer">æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ç„¡ä¿è¨¼ã§æä¾›ã•ã‚Œã¦ãŠã‚Šã€ç‚ºæ›¿å–å¼•ã«ã‚ˆã‚‹æå¤±ã«ã¤ã„ã¦ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚æŠ•è³‡åˆ¤æ–­ã¯è‡ªå·±è²¬ä»»ã§è¡Œã£ã¦ãã ã•ã„ã€‚</p>
    </footer>
  </div>
  
</body>
</html>
